<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>„Éó„É¨„Ç§</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüìö%3C/text%3E%3C/svg%3E"
    />
    <!-- Modern UI Theme -->
    <link rel="stylesheet" href="styles/modern.css?v=1" />
    <link rel="stylesheet" href="styles/play-modern.css?v=1" />
    <!-- Legacy styles for compatibility -->
    <link rel="stylesheet" href="styles/common.css?v=4" />
    <link rel="stylesheet" href="styles/play.css?v=4" />
  </head>
  <body class="play-page">
    <!-- Simplified Header -->
    <header class="app-header play-header">
      <a class="header-brand" href="index.html">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M15 18l-6-6 6-6"/>
        </svg>
        <span>„Éà„ÉÉ„Éó</span>
      </a>
      
      <h1 id="game-title" class="header-title game-title">„Çµ„É≥„Éó„É´„Ç¢„Éâ„Éô„É≥„ÉÅ„É£„Éº</h1>
      
      <nav class="header-actions">
        <!-- Navigation buttons -->
        <button id="btn-back" class="toolbar-btn" aria-label="Ââç„ÅÆ„Éé„Éº„Éâ„Å´Êàª„Çã" title="Êàª„Çã (‚Üê)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <button id="btn-forward" class="toolbar-btn" aria-label="Ê¨°„ÅÆ„Éé„Éº„Éâ„Å´ÈÄ≤„ÇÄ" title="ÈÄ≤„ÇÄ (‚Üí)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>
        
        <span class="toolbar-divider"></span>
        
        <!-- Save/Load -->
        <button id="btn-save" class="toolbar-btn" aria-label="‰øùÂ≠ò„É¢„Éº„ÉÄ„É´„ÇíÈñã„Åè" title="‰øùÂ≠ò">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
            <polyline points="17,21 17,13 7,13 7,21"/>
            <polyline points="7,3 7,8 15,8"/>
          </svg>
        </button>
        <button id="btn-load" class="toolbar-btn" aria-label="Ë™≠Ëæº„É¢„Éº„ÉÄ„É´„ÇíÈñã„Åè" title="Ë™≠Ëæº">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
        </button>
        <button id="btn-save-slots" class="toolbar-btn" title="„Çª„Éº„Éñ„Çπ„É≠„ÉÉ„Éà" aria-label="„Çª„Éº„Éñ„Çπ„É≠„ÉÉ„Éà„ÇíÈñã„Åè">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
            <line x1="8" y1="21" x2="16" y2="21"/>
            <line x1="12" y1="17" x2="12" y2="21"/>
          </svg>
        </button>
        
        <span class="toolbar-divider"></span>
        
        <!-- Inventory -->
        <button id="btn-inventory" class="toolbar-btn" title="„Ç§„É≥„Éô„É≥„Éà„É™" aria-label="„Ç§„É≥„Éô„É≥„Éà„É™„ÇíÈñã„Åè" aria-expanded="false">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/>
          </svg>
        </button>
        
        <!-- Restart -->
        <button id="btn-restart" class="toolbar-btn" aria-label="„Ç≤„Éº„É†„ÇíÊúÄÂàù„Åã„Çâ„ÇÑ„ÇäÁõ¥„Åô" title="„É™„Çπ„Çø„Éº„Éà">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="1,4 1,10 7,10"/>
            <path d="M3.51 15a9 9 0 102.13-9.36L1 10"/>
          </svg>
        </button>
        
        <span class="toolbar-divider"></span>
        
        <!-- Theme -->
        <button id="btn-theme" class="toolbar-btn" title="„ÉÜ„Éº„ÉûË®≠ÂÆö" aria-label="„ÉÜ„Éº„ÉûË®≠ÂÆö„ÇíÈñã„Åè">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
          </svg>
        </button>
        
        <!-- Import JSON -->
        <label class="toolbar-btn" aria-label="„Ç≤„Éº„É†„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÄ" title="JSON„Ç§„É≥„Éù„Éº„Éà">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
            <polyline points="14,2 14,8 20,8"/>
            <line x1="12" y1="18" x2="12" y2="12"/>
            <line x1="9" y1="15" x2="15" y2="15"/>
          </svg>
          <input id="play-file-import" type="file" accept="application/json" hidden />
        </label>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="play-main">
      <div class="play-container">
        <!-- Scene Image -->
        <div id="scene-image" class="scene-image" hidden></div>
        
        <!-- Scene Content -->
        <div class="scene-container">
          <article id="scene" class="scene scene-text" aria-live="polite" aria-atomic="true"></article>
        </div>
        
        <!-- Choices -->
        <div id="choices" class="choices" role="radiogroup" aria-label="ÈÅ∏ÊäûËÇ¢"></div>
      </div>
    </main>

    <!-- Inventory Panel (Modern) -->
    <aside
      id="inventory-panel"
      class="inventory-panel panel"
      hidden
      role="dialog"
      aria-modal="true"
      aria-labelledby="inventory-title"
    >
      <header class="panel-header">
        <h3 id="inventory-title" class="panel-title">„Ç§„É≥„Éô„É≥„Éà„É™</h3>
        <span id="inventory-count" class="text-muted text-sm" aria-live="polite"></span>
        <button id="inventory-close" class="btn-icon" title="Èñâ„Åò„Çã" aria-label="„Ç§„É≥„Éô„É≥„Éà„É™„ÇíÈñâ„Åò„Çã">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div id="inventory-list" class="panel-body inventory-list" role="list" aria-label="ÊâÄÊåÅ„Ç¢„Ç§„ÉÜ„É†"></div>
    </aside>

    <div id="theme-panel" class="theme-panel" hidden></div>

    <!-- Save Slots Panel (Modern) -->
    <aside
      id="save-slots-panel"
      class="save-slots-panel panel overlay-panel"
      hidden
      role="dialog"
      aria-modal="true"
      aria-labelledby="save-slots-header"
    >
      <header class="panel-header" id="save-slots-header">
        <h3 class="panel-title">„Çª„Éº„Éñ„Çπ„É≠„ÉÉ„Éà</h3>
        <button id="save-slots-close" class="btn-icon" title="Èñâ„Åò„Çã" aria-label="„Çª„Éº„Éñ„Çπ„É≠„ÉÉ„Éà„ÇíÈñâ„Åò„Çã">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div id="save-slots-list" class="panel-body save-slots-list"></div>
      <div class="panel-footer">
        <button id="create-new-slot" class="btn btn-primary w-full">Êñ∞Ë¶è„Çπ„É≠„ÉÉ„Éà‰ΩúÊàê</button>
      </div>
    </aside>

    <!-- Save/Load Modal (Modern) -->
    <div
      id="save-load-modal"
      class="modal-overlay"
      hidden
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
    >
      <div class="modal" role="document">
        <header class="modal-header">
          <h2 id="modal-title" class="modal-title">„Ç≤„Éº„É†„Éá„Éº„Çø„Çí‰øùÂ≠ò</h2>
          <button id="modal-close" class="btn-icon modal-close" aria-label="Èñâ„Åò„Çã">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </header>
        <section class="modal-body">
          <div id="save-panel">
            <div class="form-group">
              <label class="form-label" for="save-name">„Çª„Éº„ÉñÂêç</label>
              <input
                id="save-name"
                type="text"
                class="form-input"
                placeholder="„Çª„Éº„ÉñÂêç„ÇíÂÖ•Âäõ"
                aria-describedby="save-hint"
              />
              <p id="save-hint" class="form-hint">ÁèæÂú®„ÅÆÈÄ≤Ë°åÁä∂ÊÖã„Çí‰øùÂ≠ò„Åó„Åæ„Åô„ÄÇ</p>
            </div>
            <div class="modal-footer">
              <button id="btn-save-confirm" class="btn btn-primary">‰øùÂ≠ò„Åô„Çã</button>
            </div>
          </div>
          <div id="load-panel" hidden>
            <div class="modal-toolbar">
              <button id="btn-import-save" class="btn">„Ç§„É≥„Éù„Éº„Éà</button>
            </div>
            <div id="saved-games-list" class="saved-games-list list" role="list" aria-live="polite"></div>
          </div>
        </section>
      </div>
    </div>

    <!-- Mobile Menu (Modern) -->
    <button id="mobile-menu-btn" class="mobile-menu-btn btn-icon" aria-label="„É°„Éã„É•„Éº„ÇíÈñã„Åè">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/>
      </svg>
    </button>
    <div id="mobile-menu-overlay" class="mobile-menu-overlay modal-overlay" hidden>
      <div class="mobile-menu modal" role="dialog" aria-modal="true">
        <header class="modal-header">
          <h3 class="modal-title">„É°„Éã„É•„Éº</h3>
          <button id="mobile-menu-close" class="btn-icon" aria-label="Èñâ„Åò„Çã">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </header>
        <div class="modal-body mobile-menu-body">
          <button id="mobile-btn-save" class="btn w-full">‰øùÂ≠ò</button>
          <button id="mobile-btn-load" class="btn w-full">Ë™≠Ëæº</button>
          <button id="mobile-btn-inventory" class="btn w-full">„Ç§„É≥„Éô„É≥„Éà„É™</button>
          <button id="mobile-btn-back" class="btn w-full">Êàª„Çã</button>
          <button id="mobile-btn-forward" class="btn w-full">ÈÄ≤„ÇÄ</button>
          <button id="mobile-btn-restart" class="btn w-full">„É™„Çπ„Çø„Éº„Éà</button>
          <button id="mobile-btn-theme" class="btn w-full">„ÉÜ„Éº„Éû</button>
          <label class="btn w-full file-label">
            „Ç≤„Éº„É†JSONË™≠Ëæº
            <input id="mobile-play-file-import" type="file" accept="application/json" hidden />
          </label>
        </div>
      </div>
    </div>

    <script src="scripts/storage.js"></script>
    <script src="scripts/storageProviders.js"></script>
    <script src="scripts/storageBridge.js"></script>
    <script src="scripts/strings.js"></script>
    <script src="scripts/config.js"></script>
    <script src="scripts/errorHandler.js"></script>
    <script src="scripts/toastManager.js"></script>
    <script src="scripts/audioManager.js"></script>
    <script src="scripts/sampleData.js"></script>
    <script src="scripts/themeUtils.js"></script>
    <script src="scripts/themeUIManager.js"></script>
    <script src="scripts/themeLogicManager.js"></script>
    <script src="scripts/theme.js"></script>
    <script src="scripts/gameEngineLogicManager.js"></script>
    <script src="scripts/gameEngineUIManager.js"></script>
    <script src="scripts/gameEngineUtils.js"></script>
    <script src="scripts/gameEngine.js"></script>
    <script src="scripts/converters.js"></script>
    <!-- Modularized play scripts -->
    <script src="scripts/play.core.js"></script>
    <script src="scripts/play.save.js"></script>
    <script src="scripts/play.inventory.js"></script>
    <script src="scripts/play.input.js"></script>
    <script src="scripts/playModalFocus.js"></script>
    <script src="scripts/playModalSaveSlots.js"></script>
    <script src="scripts/play.modal.js"></script>
    <script src="scripts/play.js"></script>
    <script src="scripts/validator.js"></script>
    <script src="scripts/playImport.js"></script>

    <!-- „Éö„Éº„Ç∏Âõ∫Êúâ„ÅÆÂàùÊúüÂåñ -->
    <script>
      // „Éó„É¨„Ç§„Éö„Éº„Ç∏Áî®„ÅÆÂàùÊúüÂåñ
      document.addEventListener('DOMContentLoaded', function () {
        // ‰ªñ„ÅÆ„Éö„Éº„Ç∏„ÅÆË¶ÅÁ¥†„ÅåÊÆã„Å£„Å¶„ÅÑ„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çã„Åü„ÇÅ„ÄÅÂº∑Âà∂ÁöÑ„Å´ÈùûË°®Á§∫
        const adminElements = [
          'preview-panel',
          'memos-panel',
          'mermaid-fullscreen-modal',
          'playtest-modal',
          'node-editor-modal',
          'mermaid-inline-panel',
        ];

        adminElements.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.style.display = 'none !important';
            el.hidden = true;
            el.setAttribute('aria-hidden', 'true');
            el.setAttribute('inert', '');
          }
        });

        console.log('[PLAY] Page-specific elements hidden for play.html');
      });
    </script>
  </body>
</html>
